<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml"><head>

<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" /><title>BC EOC Expenditure Authorization</title>




<style type="text/css">

<!--

@media print {

.form-control, .form-control.nobug {

border: 0;

outline: 0;

box-shadow: none;

font-size:14px;

}

.form-control.nobug {

transition: none; /*-- THIS IS IMPORTANT -- */

}

input, textarea {

outline: none !important;

box-shadow: none;

border: none;

overflow: visible;

font-family: Arial, Helvetica, sans-serif;

font-size: 11px;

}

.formtext {

font-family: Arial, Helvetica, sans-serif;

font-size: 11pt;

font-weight: normal;

}



input[type=text], textarea {

  -webkit-transition: all 0.30s ease-in-out;

  -moz-transition: all 0.30s ease-in-out;

  -ms-transition: all 0.30s ease-in-out;

  -o-transition: all 0.30s ease-in-out;

  outline: none;

  padding: 3px 0px 3px 3px;

  margin: 5px 1px 3px 0px;

  border: 1px solid #666666;

}

 

input[type=text]:focus, textarea:focus {

  box-shadow: 0 0 5px rgba(81, 203, 238, 1);

  padding: 3px 0px 3px 3px;

  margin: 5px 1px 3px 0px;

  border: 1px solid rgba(81, 203, 238, 1);

}

</style>

<script>

function shortmonth(monthnum) {

var monthname;

shortmonths = ["JAN", "FEB", "MAR","APR", "MAY", "JUN", "JUL", "AUG", "SEP", "OCT", "NOV", "DEC"] ;

monthname = shortmonths [monthnum];s

return monthname; }

</script>

<script>

function SetDateTime(TType,TheFld, FocusFld) {

var txt;

var myprompt;

var d = new Date(),

thisyear = d.getFullYear();

thismonth= d.getMonth();

thisday = d.getDate();

var monname;

h = (d.getHours()<10?'0':'') + d.getHours()

m = (d.getMinutes()<10?'0':'') + d.getMinutes()

s = (d.getSeconds()<10?'0':'') + d.getSeconds();

var now = new Date();

var utch = now.getUTCHours();

if (utch < 10) { utch = "0"+utch};

var utcs = now.getUTCMinutes();

if (utcs < 10) { utcs = "0"+utcs};

var myUTCtime = utch+":"+utcs+"Z";

var utcstr = d.toUTCString();

var localt = d.toLocaleTimeString();

var isostr = d.toISOString();

monthname = shortmonth (thismonth);

thismonth = thismonth + 1;

switch (TType) {

case 'hms' :

myprompt = h + ':' + m + ':' + s;

var RightNow = prompt("Time:", myprompt);

document.getElementById(TheFld).value = RightNow;

break;

case 'hm' :

myprompt = h + ':' + m;

var RightNow = prompt("Time:", myprompt);

document.getElementById(TheFld).value = RightNow;

break;

case 'm-d-y': myprompt = thismonth+ '-' + thisday+ '-'+ thisyear;

var RightNow = prompt("Date:", myprompt);

document.getElementById(TheFld).value = RightNow;

break;

case 'm/d/y': myprompt = thismonth+ '/' + thisday+ '/'+ thisyear;

var RightNow = prompt("Date:", myprompt);

document.getElementById(TheFld).value = RightNow;

break;

case 'd mmm y': myprompt = thisday+ ' ' + monthname+ ' '+ thisyear;

var RightNow = prompt("Date:", myprompt);

document.getElementById(TheFld).value = RightNow;

break;

case 'mmm-d-y': myprompt = monthname+'-'+thisday+ '-' + thisyear;

var RightNow = prompt("Date:", myprompt);

document.getElementById(TheFld).value = RightNow;

break;

case 'localampm': var myprompt = localt;

var RightNow = prompt("Local time:", myprompt);

document.getElementById(TheFld).value = RightNow;

break;

case 'fulldate': var myprompt = thisyear+ '-'+thismonth+'-'+thisday;

var RightNow = prompt("Date:", myprompt);

document.getElementById(TheFld).value = RightNow;

break;

case 'fulldatetime': var myprompt = thisyear+'-'+thismonth+ '-'+thisday+' '+h + ':' + m ;

var RightNow = prompt("Date time:", myprompt);

document.getElementById(TheFld).value = RightNow;

break;

case 'autodate': var RightNow = thisyear+'-'+thismonth+ '-'+thisday ;

//var RightNow = prompt("Date time:", myprompt);

document.getElementById(TheFld).value = RightNow;

break;

case 'autotime': var RightNow = h + ':' + m ;

//var RightNow = prompt("Date time:", myprompt);

document.getElementById(TheFld).value = RightNow;

break;

case 'iso': var myprompt = isostr;

var RightNow = prompt("Date time:", myprompt);

document.getElementById(TheFld).value = RightNow;

break;

case 'utc': var myprompt = utcstr;

var RightNow = prompt("Date time:", myprompt);

document.getElementById(TheFld).value = RightNow;

break;

case 'zulu': var myprompt = isostr;

myprompt = isostr.replace("T", " "); slen = myprompt.length;

myprompt = myprompt.substr(0, slen-5)+'Z';

var RightNow = prompt("Date time:", myprompt);

document.getElementById(TheFld).value = RightNow;

break;

case 'UTChm': var myprompt = myUTCtime;

var RightNow = prompt("Date time:", myprompt);

document.getElementById(TheFld).value = RightNow;

break;

}

// if(FocusFld !== null && FocusFld !== '') {document.getElementById(FocusFld).focus()} --/

}; </script>

<script>

function AutoGrowTextArea(textField)

{

if (textField.clientHeight < textField.scrollHeight)

{

textField.style.height = textField.scrollHeight + "px";

if (textField.clientHeight < textField.scrollHeight)

{

textField.style.height = (textField.scrollHeight * 2 - textField.clientHeight) + "px";

}

}

}

function Countthelines(f) { var text1 = f

var text2 = text1.replace(/\s+$/,"");

var split2 = text2.split("\n"); var mytotal = split2.length * 17;

if (mytotal < 150) {

mytotal = 150;

}

var tstr = mytotal.toString();

return tstr;

}

function newfix(f){

var ThisText = document.getElementById(f).value;

var makeit = Countthelines(ThisText);

document.getElementById(f).style.height = makeit+"px"; }

function Fixarea() {

newfix("msg");

newfix("reply");

AutoGrowTextArea(document.getElementById("msg"));

AutoGrowTextArea(document.getElementById("reply"));

}

function RWS(str){

var text2 = str.replace(/\s+$/,"");

return text2.trim();

}

function Flip(theid,working) {

x1 = document.getElementById(theid).value;

if (x1 == '' || x1 == '') { document.getElementById(theid).value = working} 

else { document.getElementById(theid).value = '';}

}

function shortmonth(monthnum) {

var monthname;

shortmonths = ["JAN", "FEB", "MAR","APR", "MAY", "JUN", "JUL", "AUG", "SEP", "OCT", "NOV", "DEC"] ;

monthname = shortmonths [monthnum];

return monthname; }

</script>

<script>

function SetDateTime(TType,TheFld, FocusFld) {

var txt;

var myprompt;

var d = new Date(),

thisyear = d.getFullYear();

thismonth= d.getMonth();

thisday = d.getDate();

var submonth = thismonth+1; ;

if (submonth < 10) { submonth = "0"+submonth};

var subday = thisday;

if (thisday < 10) { thisday = "0"+thisday};

var monname;

h = (d.getHours()<10?'0':'') + d.getHours()

m = (d.getMinutes()<10?'0':'') + d.getMinutes()

s = (d.getSeconds()<10?'0':'') + d.getSeconds();

var now = new Date();

var utch = now.getUTCHours();

if (utch < 10) { utch = "0"+utch};

var utcs = now.getUTCMinutes();

if (utcs < 10) { utcs = "0"+utcs};

var myUTCtime = utch+":"+utcs+"Z";

var utcstr = d.toUTCString();

var localt = d.toLocaleTimeString();

var isostr = d.toISOString();

monthname = shortmonth (thismonth);

thismonth = thismonth + 1;

switch (TType) {

case 'hms' :

myprompt = h + ':' + m + ':' + s;

var RightNow = prompt("Time:", myprompt);

document.getElementById(TheFld).value = RightNow;

break;

case 'hm' :

myprompt = h + ':' + m;

var RightNow = prompt("Time:", myprompt);

document.getElementById(TheFld).value = RightNow;

break;

case 'm-d-y': myprompt = thismonth+ '-' + thisday+ '-'+ thisyear;

var RightNow = prompt("Date:", myprompt);

document.getElementById(TheFld).value = RightNow;

break;

case 'm/d/y': myprompt = thismonth+ '/' + thisday+ '/'+ thisyear;

var RightNow = prompt("Date:", myprompt);

document.getElementById(TheFld).value = RightNow;

break;

case 'd mmm y': myprompt = thisday+ ' ' + monthname+ ' '+ thisyear;

var RightNow = prompt("Date:", myprompt);

document.getElementById(TheFld).value = RightNow;

break;

case 'mmm-d-y': myprompt = monthname+'-'+thisday+ '-' + thisyear;

var RightNow = prompt("Date:", myprompt);

document.getElementById(TheFld).value = RightNow;

break;

case 'localampm': var myprompt = localt;

var RightNow = prompt("Local time:", myprompt);

document.getElementById(TheFld).value = RightNow;

break;

case 'fulldate': var myprompt = thisyear+ '-'+thismonth+'-'+thisday;

var RightNow = prompt("Date:", myprompt);

document.getElementById(TheFld).value = RightNow;

break;

case 'fulldatetime': var myprompt = thisyear+'/'+thismonth+ '/'+thisday+' '+h  + ':'+m ;

var RightNow = prompt("Date time:", myprompt);

document.getElementById(TheFld).value = RightNow;

break;

case 'autofulldatetime': var RightNow = thisyear+'-'+thismonth+ '-'+thisday+' '+h + ':' + m ;

//var RightNow = prompt("Date time:", myprompt);

//document.getElementById(TheFld).value = RightNow;

//var ORTimestamp = thisyear+submonth+subday+h+m+s;

//document.getElementById('TimeStampOR').value = ORTimestamp; break;

case 'iso': var myprompt = isostr;

var RightNow = prompt("Date time:", myprompt);

document.getElementById(TheFld).value = RightNow;

break;

case 'utc': var myprompt = utcstr;

var RightNow = prompt("Date time:", myprompt);

document.getElementById(TheFld).value = RightNow;

break;

case 'zulu': var myprompt = isostr;

myprompt = isostr.replace("T", " "); slen = myprompt.length;

myprompt = myprompt.substr(0, slen-5)+'Z';

var RightNow = prompt("Date time:", myprompt);

document.getElementById(TheFld).value = RightNow;

break;

case 'UTChm': var myprompt = myUTCtime;

var RightNow = prompt("Date time:", myprompt);

document.getElementById(TheFld).value = RightNow;

break;

}

}

</script>

<style>

<!--

TD{ bgcolor="#ffffff" valign="top"}

.SubmitBtn {font-size: 12px;

font-family: Arial,Helvetica,sans-serif;

font-weight: inherit;

}

</script>

.style24 {font-family: Arial,Helvetica,sans-serif; font-size: 20px}

</style>

<style>

/*

body {color:#000; background:#fff; font:100%/1.5 arial,sans-serif;}

h2 {margin-top:0}

*/

/* Styling applied to classes only */

/* Pop-up content shifted off-screen when not in view.

Still readable by screen-reader software.

When targeted it fills the browser window.

*/

.pop-up {position:absolute; top:0; left:-500em;}

.pop-up:target {position:static; left:0;}

/* The pop-up itself */

.popBox {

background:#ffffff;

/* alternatively fixed width / height and negative margins from 50% */

position:absolute; left:30%; right:30%; top:25%; bottom:25%;

z-index:10;

border:1px solid #3a3a3a;

/* CSS3 where available: rounded corners, drop-shadow, and fade in. */

border-radius:.25rem;

box-shadow:0 .5rem .5rem rgba(0,0,0,.5);

opacity:0;

transition: opacity 0.8s ease-out;

}

:target .popBox {position:fixed; opacity:1;}

/* Light box properties */

.lightbox {

display:none;

text-indent:-200em;

background-color:rgba(0,0,0,.4);

width:100%;

height:100%;

position:fixed;

top:0;

left:0;

bottom:0;

right:0;

z-index:5;

}

:target .lightbox {display:block;}

/* The pop-ups close link, moved via CSS to the top right of the pop-up */

.close:link,

.close:visited {

position: absolute;

top: -0.75em;

right: -0.75em;

display: block;

width: 2em;

height: 2em;

line-height: 1.8;

padding: 0;

text-align: center;

text-decoration: none;

background-color: #000;

border: 2px solid #fff;

color: #fff;

border-radius: 50%;

box-shadow: 0 0 .5rem .5rem rba(0,0,0,.5);

}

.close:before {content:"X";}

.close:hover,

.close:active,

.close:focus {

box-shadow: 0 0 .5rem .5rem rba(255,0,0,.5);

background-color: #c00;

color: #fff;

}

.close span {

text-indent: -200em;

display: block;

}

/* The pop-up content div will scroll if it has too much content */

.popScroll {

position:absolute;

top: 1rem;

left: 1rem;

right: 1rem;

bottom: 1rem;

overflow-y: auto;

*overflow-y: scroll;

padding-right: 0.5em;

}


.popScroll h2 {margin-top:0}

.style6 {

font-family: Arial, Helvetica, sans-serif;

font-size: 20px;

}

.style11 {

font-size: 9pt;

color: #006600;

}

.Kopfzeile2 {font-family: Arial,Helvetica,sans-serif;
font-size: 12px;
color: #000000;
text-align: center;
background-color: #efefef;
}
.style12 {font-size: 10pt}
.style13 {font-size: 9pt}
.style1 {color: #FF0000}
.style9 {font-size: 12px}
</style>
<script>
function formatNumber (num, hfield) {
//document.getElementById(hfield).value = num;
    return "$ "+ num.toString().replace(/(\d)(?=(\d{3})+(?!\d))/g, "$1,")
}

function isNumberKey(evt)
{
var charCode = (evt.which) ? evt.which : event.keyCode
if (charCode < 48 || charCode > 57)
return false;
return true;
}
function Flip(theid,working) {
x1 = document.getElementById(theid).value;
if (x1 == '' || x1 == '') { document.getElementById(theid).value = working} 
else { document.getElementById(theid).value = '';}
}

function DateTime() {
var txt;
var myprompt;
var d = new Date(),
thisyear = d.getFullYear();
thismonth= d.getMonth();
thisday = d.getDate();
var monname;
h = (d.getHours()<10?'0':'') + d.getHours()
m = (d.getMinutes()<10?'0':'') + d.getMinutes()
var Localtime = h + m+'L ';
var UTCYear = d.getUTCFullYear();
var now = new Date();
var utch = now.getUTCHours();
if (utch < 10) { utch = '0'+utch};
var utcs = now.getUTCMinutes();
if (utcs < 10) { utcs = '0'+utcs};
var myUTCtime = utch+""+utcs+"Z";
var utcstr = d.toUTCString();
var localt = d.toLocaleTimeString();
var isostr = d.toISOString();
monthname = shortmonth (thismonth);
var thismonth = thismonth + 1;
  if (thismonth < 10) { thismonth = "0" + thismonth}
var UTCdate = d.getUTCDate();
var UTCmon = d.getUTCMonth();
var UTCmon = UTCmon+1;
 if (UTCmon < 10) { UTCmon = "0" + UTCmon}
//var utcmonthname = shortmonth (UTCmon);
var UTCmmdd =UTCYear+"-"+UTCmon + "-"+UTCdate;
var Localdate = thisyear+'-'+thismonth+'-'+thisday;
var Rightnow =Localdate; //UTCmmdd
if (document.getElementById('tformat').checked) { Rightnow = UTCmmdd};
document.getElementById('fld1').value = Rightnow;
var Rightnow = Localtime; //myUTCtime
if (document.getElementById('tformat').checked) { Rightnow = myUTCtime};
document.getElementById('fld2').value = Rightnow;

//if (document.getElementById('tformat').checked) { Rightnow = Localdate};
//document.getElementById('Date').value = Rightnow;
//var Rightnow = myUTCtime;
//if (document.getElementById('tformat').checked) { Rightnow = Localtime};
document.getElementById('Time1').value = Rightnow;

// if(FocusFld !== null && FocusFld !== '') {document.getElementById(FocusFld).focus()} --/
};
</script>
<script>
// Test auto collect

function AutoGrowTextArea(textField)
{
  if (textField.clientHeight < textField.scrollHeight)
  {
    textField.style.height = textField.scrollHeight + "px";
    if (textField.clientHeight < textField.scrollHeight)
    {
      textField.style.height = 
        (textField.scrollHeight * 2 - textField.clientHeight) + "px";
    }
  }
}

function saveTextAsFile(fileNameToSaveAs, textToWrite) {
var textToWrite = document.getElementById('parseme').value; 
var fileNameToSaveAs = "BC Resource Request data " + DateforFile()+".txt";
fileNameToSaveAs = prompt("", fileNameToSaveAs);

  /* Saves a text string as a blob file*/  
  var ie = navigator.userAgent.match(/MSIE\s([\d.]+)/),
      ie11 = navigator.userAgent.match(/Trident\/7.0/) && navigator.userAgent.match(/rv:11/),
      ieEDGE = navigator.userAgent.match(/Edge/g),
      ieVer=(ie ? ie[1] : (ie11 ? 11 : (ieEDGE ? 12 : -1)));

  if (ie && ieVer<10) {
    console.log("No blobs on IE ver<10");
    return;
  }

  var textFileAsBlob = new Blob([textToWrite], {
    type: 'text/plain'
  });

  if (ieVer>-1) {
    window.navigator.msSaveBlob(textFileAsBlob, fileNameToSaveAs);

  } else {
    var downloadLink = document.createElement("a");
    downloadLink.download = fileNameToSaveAs;
    downloadLink.href = window.URL.createObjectURL(textFileAsBlob);
    downloadLink.onclick = function(e) { document.body.removeChild(e.target); };
    downloadLink.style.display = "none";
    document.body.appendChild(downloadLink);
    downloadLink.click();
  }
}





function destroyClickedElement(event)
{
    document.body.removeChild(event.target);
}

function loadFileAsText()
{

    var fileToLoad = document.getElementById("fileToLoad").files[0];
 
    var fileReader = new FileReader();
    fileReader.onload = function(fileLoadedEvent) 
    {
        var textFromFileLoaded = fileLoadedEvent.target.result;
        document.getElementById("inputTextToSave").value = textFromFileLoaded;
    };
    fileReader.readAsText(fileToLoad, "UTF-8");
}


function DateforFile(RightNow) {
var txt;
var d = new Date(),
thisyear = d.getFullYear();
thismonth= d.getMonth();
thismonth = thismonth+1;
if (thismonth < 10) { thismonth = "0" + thismonth}

thisday = d.getDate();
if (thisday < 10) { thisday = "0" + thisday}

h = (d.getHours()<10?'0':'') + d.getHours()
m = (d.getMinutes()<10?'0':'') + d.getMinutes()
var myprompt = thisyear+ '-'+thismonth+'-'+thisday+' '+h + '_' + m ;
return myprompt;
}

function isObject(arg) {
  return Object.prototype.toString.call(arg)==='[object Object]';
}

function formDataToObject(elForm) {
  if (!elForm instanceof Element) return;
  var fields = elForm.querySelectorAll('input, select, textarea'),
    o = {};
  for (var i=0, imax=fields.length; i<imax; ++i) {
    var field = fields[i],
      sKey = field.name || field.id;
    if (field.type==='button' || field.type==='image' || field.type==='submit' || !sKey) continue;
    switch (field.type) {
      case 'checkbox':
        o[sKey] = +field.checked;
        break;
      case 'radio':
        if (o[sKey]===undefined) o[sKey] = '';
        if (field.checked) o[sKey] = field.value;
        break;
      case 'select-multiple':
        var a = [];
        for (var j=0, jmax=field.options.length; j<jmax; ++j) {
          if (field.options[j].selected) a.push(field.options[j].value);
        }
        o[sKey] = a;
        break;
      default:
        o[sKey] = field.value;
    }
  }
 // alert('Form data:\n\n' + JSON.stringify(o, null, 2));
 document.getElementById('parseme').value = JSON.stringify(o, null, 2);
//  return o;
}

function populateForm(o) {

o =  JSON.parse(document.getElementById('parseme').value);
 //if (!isObject(o)) return;
if (!isObject(o)) return;
  for (var i in o) {
    var el = document.getElementById(i) || document.querySelector('[name=' + i + ']');
    if (el.type==='radio') el = document.querySelectorAll('[name=' + i + ']');
    switch (typeof o[i]) {
      case 'number':
        el.checked = o[i];
        break;
      case 'object':
        if (el.options && o[i] instanceof Array) {
          for (var j=0, jmax=el.options.length; j<jmax; ++j) {
            if (o[i].indexOf(el.options[j].value)>-1) el.options[j].selected = true;
          }
        }
        break;
      default:
        if (el instanceof NodeList) {
          for (var j=0, jmax=el.length; j<jmax; ++j) {
            if (el[j].value===o[i]) el[j].checked = true;
          }
        } else {
          el.value = o[i];
        }
    }
  }
    Fixfields();


}

function SaveData() {
	
			formDataToObject(document.getElementById('myform'))
			saveTextAsFile();
			
			//saveTextAsFile();
			}

//-------
 function readBlob(opt_startByte, opt_stopByte) {
  
    var files = document.getElementById('files').files;
    if (!files.length) {
      alert('Please select a file!');
      return;
    }

    var file = files[0];
    var start = parseInt(opt_startByte) || 0;
    var stop = parseInt(opt_stopByte) || file.size - 1;

    var reader = new FileReader();

    // If we use onloadend, we need to check the readyState.
    reader.onloadend = function(evt) {
      if (evt.target.readyState == FileReader.DONE) { // DONE == 2
        document.getElementById('byte_content').textContent = evt.target.result;
        document.getElementById('byte_range').textContent = 
            ['Read bytes: ', start + 1, ' - ', stop + 1,
             ' of ', file.size, ' byte file'].join('');
      }
    };

    var blob = file.slice(start, stop + 1);
    reader.readAsBinaryString(blob);
  }
    	
  window.onload = function () { 
 
 //Check the support for the File API support 
 if (window.File && window.FileReader && window.FileList && window.Blob) {
    var fileSelected = document.getElementById('txtfiletoread');
	
    fileSelected.addEventListener('change', function (e) { 
         //Set the extension for the file 
         var fileExtension = /text.*/; 
         //Get the file object 
         var fileTobeRead = fileSelected.files[0];
        //Check of the extension match 
         if (fileTobeRead.type.match(fileExtension)) { 
             //Initialize the FileReader object to read the 2file 
			
             var fileReader = new FileReader(); 
             fileReader.onload = function (e) { 
                 var fileContents = document.getElementById('filecontents'); 
                
				document.getElementById('parseme').value =fileReader.result;
				populateForm(obj = document.getElementById('parseme').value);
					 } 
             fileReader.readAsText(fileTobeRead); 
         } 
         else { 
             alert("Please select text file"); 
         }
 
    }, false);
} 
 else { 
     alert("Files are not supported"); 
 } 
DateTime();
 Fixfields();
 }
 
 function Fixfields() {
AutoGrowTextArea(document.getElementById("fld13"));
}
// function setcolors() {

</script>

</script>

<script>
// Test auto collect

function AutoGrowTextArea(textField)
{
  if (textField.clientHeight < textField.scrollHeight)
  {
    textField.style.height = textField.scrollHeight + "px";
    if (textField.clientHeight < textField.scrollHeight)
    {
      textField.style.height = 
        (textField.scrollHeight * 2 - textField.clientHeight) + "px";
    }
  }
}

function saveTextAsFile(fileNameToSaveAs, textToWrite) {
var textToWrite = document.getElementById('parseme').value; 
var fileNameToSaveAs = "BC EOC Expenditure " + DateforFile()+".txt";
fileNameToSaveAs = prompt("", fileNameToSaveAs);

  /* Saves a text string as a blob file*/  
  var ie = navigator.userAgent.match(/MSIE\s([\d.]+)/),
      ie11 = navigator.userAgent.match(/Trident\/7.0/) && navigator.userAgent.match(/rv:11/),
      ieEDGE = navigator.userAgent.match(/Edge/g),
      ieVer=(ie ? ie[1] : (ie11 ? 11 : (ieEDGE ? 12 : -1)));

  if (ie && ieVer<10) {
    console.log("No blobs on IE ver<10");
    return;
  }

  var textFileAsBlob = new Blob([textToWrite], {
    type: 'text/plain'
  });

  if (ieVer>-1) {
    window.navigator.msSaveBlob(textFileAsBlob, fileNameToSaveAs);

  } else {
    var downloadLink = document.createElement("a");
    downloadLink.download = fileNameToSaveAs;
    downloadLink.href = window.URL.createObjectURL(textFileAsBlob);
    downloadLink.onclick = function(e) { document.body.removeChild(e.target); };
    downloadLink.style.display = "none";
    document.body.appendChild(downloadLink);
    downloadLink.click();
  }
}





function destroyClickedElement(event)
{
    document.body.removeChild(event.target);
}

function loadFileAsText()
{

    var fileToLoad = document.getElementById("fileToLoad").files[0];
 
    var fileReader = new FileReader();
    fileReader.onload = function(fileLoadedEvent) 
    {
        var textFromFileLoaded = fileLoadedEvent.target.result;
        document.getElementById("inputTextToSave").value = textFromFileLoaded;
    };
    fileReader.readAsText(fileToLoad, "UTF-8");
}


function DateforFile(RightNow) {
var txt;
var d = new Date(),
thisyear = d.getFullYear();
thismonth= d.getMonth();
thismonth = thismonth+1;
if (thismonth < 10) { thismonth = "0" + thismonth}

thisday = d.getDate();
if (thisday < 10) { thisday = "0" + thisday}

h = (d.getHours()<10?'0':'') + d.getHours()
m = (d.getMinutes()<10?'0':'') + d.getMinutes()
var myprompt = thisyear+ '-'+thismonth+'-'+thisday+' '+h + '_' + m ;
return myprompt;
}

function isObject(arg) {
  return Object.prototype.toString.call(arg)==='[object Object]';
}

function formDataToObject(elForm) {
  if (!elForm instanceof Element) return;
  var fields = elForm.querySelectorAll('input, select, textarea'),
    o = {};
  for (var i=0, imax=fields.length; i<imax; ++i) {
    var field = fields[i],
      sKey = field.name || field.id;
    if (field.type==='button' || field.type==='image' || field.type==='submit' || !sKey) continue;
    switch (field.type) {
      case 'checkbox':
        o[sKey] = +field.checked;
        break;
      case 'radio':
        if (o[sKey]===undefined) o[sKey] = '';
        if (field.checked) o[sKey] = field.value;
        break;
      case 'select-multiple':
        var a = [];
        for (var j=0, jmax=field.options.length; j<jmax; ++j) {
          if (field.options[j].selected) a.push(field.options[j].value);
        }
        o[sKey] = a;
        break;
      default:
        o[sKey] = field.value;
    }
  }
 // alert('Form data:\n\n' + JSON.stringify(o, null, 2));
 document.getElementById('parseme').value = JSON.stringify(o, null, 2);
//  return o;
}

function populateForm(o) {

o =  JSON.parse(document.getElementById('parseme').value);
 //if (!isObject(o)) return;
if (!isObject(o)) return;
  for (var i in o) {
    var el = document.getElementById(i) || document.querySelector('[name=' + i + ']');
    if (el.type==='radio') el = document.querySelectorAll('[name=' + i + ']');
    switch (typeof o[i]) {

      case 'number':
        el.checked = o[i];
        break;
      case 'object':
        if (el.options && o[i] instanceof Array) {
          for (var j=0, jmax=el.options.length; j<jmax; ++j) {
            if (o[i].indexOf(el.options[j].value)>-1) el.options[j].selected = true;
          }
        }
        break;
      default:
        if (el instanceof NodeList) {
          for (var j=0, jmax=el.length; j<jmax; ++j) {
            if (el[j].value===o[i]) el[j].checked = true;
          }
        } else {
          el.value = o[i];
        }
    }
  }
    Fixfields();


}

function SaveData() {
	
			formDataToObject(document.getElementById('myform'))
			saveTextAsFile();
			
			//saveTextAsFile();
			}

//-------
 function readBlob(opt_startByte, opt_stopByte) {
  
    var files = document.getElementById('files').files;
    if (!files.length) {
      alert('Please select a file!');
      return;
    }

    var file = files[0];
    var start = parseInt(opt_startByte) || 0;
    var stop = parseInt(opt_stopByte) || file.size - 1;

    var reader = new FileReader();

    // If we use onloadend, we need to check the readyState.
    reader.onloadend = function(evt) {
      if (evt.target.readyState == FileReader.DONE) { // DONE == 2
        document.getElementById('byte_content').textContent = evt.target.result;
        document.getElementById('byte_range').textContent = 
            ['Read bytes: ', start + 1, ' - ', stop + 1,
             ' of ', file.size, ' byte file'].join('');
      }
    };

    var blob = file.slice(start, stop + 1);
    reader.readAsBinaryString(blob);
  }
    	
  window.onload = function () { 
 //Check the support for the File API support 
 if (window.File && window.FileReader && window.FileList && window.Blob) {
    var fileSelected = document.getElementById('txtfiletoread');
	
    fileSelected.addEventListener('change', function (e) { 
         //Set the extension for the file 
         var fileExtension = /text.*/; 
         //Get the file object 
         var fileTobeRead = fileSelected.files[0];
        //Check of the extension match 
         if (fileTobeRead.type.match(fileExtension)) { 
             //Initialize the FileReader object to read the 2file 
			
             var fileReader = new FileReader(); 
             fileReader.onload = function (e) { 
                 var fileContents = document.getElementById('filecontents'); 
                
				document.getElementById('parseme').value =fileReader.result;
				populateForm(obj = document.getElementById('parseme').value);
					 } 
             fileReader.readAsText(fileTobeRead); 
         } 
         else { 
             alert("Please select text file"); 
         }
 
    }, false);
} 
 else { 
     alert("Files are not supported"); 
 } 
DateTime();
 Fixfields();
 }
 
 function Fixfields() {
AutoGrowTextArea(document.getElementById("fld41"));
}
// function setcolors() {

</script>



</head>

<body >

<form  style="font-family: Arial;" pbzloc="3" onsubmit="return confirm('To complete your form submission, click OK and close the open browser window. You will return to the new message window so you can post your message to the outbox');" method="post" id="myform" enctype="multipart/form-data" action="http://{FormServer}:{FormPort}">
<div id="pop1" class="pop-up"><!-- The pop-up block -->

<div class="popBox"><!-- If the content becomes larger than the pop-up this div will scroll the content -->

<div class="popScroll"><!-- Test for help starts here -->

<h4><p align="center">BC EOC Expenditure Authorization</p></h4>

<p align="left"><strong>Introduction. </strong><br />

<br />  <span class="formtext"> 

This is a radio delivery based BC EOC Expenditure Authorization template. 

<br />

<br />

* NOTE on printing:<br />

<br />

Printing this form is dependent upon your selected

printer and its settings. Various Web Browsers and and their viewing

sizes are not all the same. Printing from a browsers print function

may be different from the operating systems default print mode.

Select what works for you, for both printing and viewing.

You may print direct to the printer as a HTML or save as a

PDF then print the PDF. In some instances Landscape mode may print

better than Portrait. <br />
</span>
</p>

. <td width="0%"></p>

</div>

<!-- The close pop-up link correctly positioned at the end of the content block -->

<a href="#links" class="close"><span>Back

to links</span></a> </div></div>
<span class="formtext"><strong><span style="font-weight: bold;">
</span></strong></span>
<table style="width: 900px; " border="1" cellpadding="3" cellspacing="0">

<colgroup><col width="657" /></colgroup> <tbody>

<tr valign="top" bgcolor="#f8f8ff">

<td height="35" colspan="3">

<div  align="center">
  <p class="style6">&nbsp; &nbsp;<small><span style="font-size: 12px;"><strong><small><span style="font-size: 12px;"><strong><small><span style="font-size: 12px;"><strong> &nbsp;<small><span style="font-size: 14px;"><big style="font-weight: bold;"><big>&nbsp;</big></big></span></small></strong></span></small></strong></span></small></strong></span></small> &nbsp; &nbsp; &nbsp;BC EOC Expenditure Authorization<small><span style="font-size: 12px;"><strong><small><span style="font-size: 12px;"><strong><small><span style="font-size: 12px;"><strong><small><span style="font-size: 14px;"><big style="font-weight: bold;"><big>&nbsp;</big></big></span></small></strong></span><span style="font-size: 14px;"><big style="font-weight: bold;"><big>&nbsp;</big></big></span></small><small><span style="font-size: 12px;"><strong> &nbsp;<small><span style="font-size: 14px;"><big style="font-weight: bold;"><big>&nbsp;</big></big></span></small></strong></span></small></strong></span></small><small><span style="font-size: 14px;"><big style="font-weight: bold;"><big>&nbsp;</big></big></span><big style="font-weight: bold;"><big><strong><small><big><small><big><span style="font-weight: normal;"><small><span class="style9"><a href="#pop1"></a></span></small></span></big></small></big></small></strong></big></big></small></strong></span></small></p>
  <p class="style6"><input type="button" value=" Load BC EOC Expenditure Data" onclick="document.getElementById('txtfiletoread').click();" />
    <input type="file" id="txtfiletoread" accept=".txt"  style="display: none;"/></p></p>
</div>

</td>

</tr>
<tr valign="top">

</tr>
<tr valign="top">

<td width="232" nowrap="nowrap"" class="formtext" stext-align: right;><div align="left"><span style="font-weight: bold;">&nbsp;</span>Event: 
    <span style="font-weight: bold;">&nbsp;</span>
    &nbsp;<input maxlength="38" name="fld1" id="fld1" size="40" required="required"/>
          <br />
    
</div></td>

<td width="280" nowrap="nowrap"" class="formtext" stext-align: right;><div align="left"><span style="font-weight: bold;">&nbsp;</span>Date:
      <input placeholder="Click for Date" maxlength="6" name="fld2" id="fld2" size="6" />
      <span style="font-weight: bold;">&nbsp;</span>Time:
      <input placeholder="Click for Time" maxlength="6" name="fld5" id="fld5" size="6" />
</div></td>
<td width="342" rowspan="2" nowrap="nowrap"" class="formtext" text-align: right;><div align="left"><span style="font-weight: bold;"><span style="font-weight: bold;">&nbsp;</span> &nbsp;</span>EAF#: 
    <input placeholder="" maxlength="28" name="fld3" id="fld3" size="30" />
<textarea name="parseme" cols="60" id="parseme" style="display: none;"></textarea> </div></td>
</tr>
<tr valign="top">
  <td nowrap="nowrap"" class="formtext" stext-align: right;><span style="font-weight: bold;">&nbsp;</span>EMBC Task #:    
    <input placeholder="" maxlength="28" name="fld4" id="fld4" size="30" /></td>
  <td nowrap="nowrap" bgcolor="#FFFFCC"" class="formtext" stext-align: right ;><input name="tformat" id="tformat" value="Local" onclick="DateTime()" type="checkbox" />
Change to Time/Date to UTC</td>
  </tr>
<tr valign="top">
  <td colspan="3" class="formtext"> <span style="font-weight: bold;">&nbsp;<span style="font-weight: bold;">&nbsp;</span></span>Priority:
    <input name="PriB" type="radio" value="High (Emergency)" onclick=" document.getElementById('Pri').value = 'High (Emergency)';" />
High (Emergency) <span style="font-weight: bold;">&nbsp;</span> <span style="font-weight: bold;">&nbsp;</span>
<input name="PriB" type="radio" value="Medium (Priority)" onclick=" document.getElementById('Pri').value = 'Medium';" />
Medium (Priority) <span style="font-weight: bold;">&nbsp;</span> <span style="font-weight: bold;">&nbsp;</span>
<input name="PriB" type="radio" value="Low (Routine)" checked="checked" onclick=" document.getElementById('Pri').value = 'Low (Routine)';" />
Low (Routine)
<input name="Pri" type="hidden" id="Pri" value="Low (Routine)" /></td>
</tr>
<tr valign="top" bgcolor="#f8f8ff">

<td colspan="3" rowspan="1" class="formtext"><strong><span class="style15">&nbsp;</span>Requesting Organization/Community: </strong></td>

</tr>

<tr valign="top">

<td colspan="3" cclass="formtext">

<table width="100%" border="1" cellpadding="4" cellspacing="0" style="text-align: left;">

<tbody>

<tr valign="top" class="formtext">
  <td width="33%" nowrap="nowrap"><span style="font-weight: bold;">&nbsp;</span>Authorized Representative:</td>
  <td width="31%" nowrap="nowrap"><span style="font-weight: bold;">&nbsp;</span>Name: 
    <input placeholder="" maxlength="33" name="fld6" id="fld6" size="35" /></td>
  <td width="36%" nowrap="nowrap"><span style="font-weight: bold;">&nbsp;</span>Location:
      <input placeholder="" maxlength="33" name="fld7" id="fld7" size="35" />

    </td>
</tr>
<tr valign="top" class="formtext">

<td rowspan="1">

  <span style="font-weight: bold;">&nbsp;</span>Telephone :
  <input maxlength="21" name="fld8" id="fld8" size="22" /></td>
<td rowspan="1"><span style="font-weight: bold;">&nbsp;</span>FAX :
  <input  maxlength="21" name="fld9" id="fld9" size="22" /></td>
<td rowspan="1"><span style="font-weight: bold;">&nbsp;</span>Email: 
  <input placeholder="" maxlength="33" name="fld10" id="fld10" size="35"  /></td>
</tr>
<tr>
  <td colspan="3" class="formtext"><strong>&nbsp;Description of Expenditure:</strong><span class="style16"> (include nature of goods and/or services being acquired/provided, desired outcome, location, date/time planned&hellip;)</span></span><br />
    &nbsp;
    <textarea name="fld11" cols="110" rows="2" id="fld11"onchange="this.value=RWS(this.value)" onkeyup="AutoGrowTextArea(this)" ></textarea>
    </span></td>
</tr>
<tr>
  <td colspan="3" class="formtext"> <table width="100%"  border="1" cellpadding="0" cellspacing="0" bordercolor="#CCCCCC">
      <tr valign="top">
        <td width="52%" height="20"><span style="font-weight: bold;">&nbsp;</span>Amount Requested: 
          <input maxlength="21" name="fld12" id="fld12" placeholder = "Numbers only"size="22"onkeypress="return isNumberKey(event)" onchange="this.value=formatNumber (this.value, 'fld12');" />
          </td>
        <td width="48%"><span style="font-weight: bold;">&nbsp;</span>Expenditure Not to Exceed: 
          <input maxlength="21" name="fld13" id="fld13" placeholder = "Numbers only"size="22"onkeypress="return isNumberKey(event)" onchange="this.value=formatNumber (this.value, 'fld13');" /></td>
        </tr>
    </table>
    </td>
</tr>

</tbody>

</table>

</td>

</tr>
<tr valign="top">
  <td colspan="3" class="formtext"><table width="100%" height="72" border="1" cellpadding="0" cellspacing="0" style="text-align: left; ">
    <tbody>
      
      <tr class="formtext">
        <td height="70"  colspan="3" valign="top" nowrap="nowrap"><table width="100%"  border="1" cellpadding="4" cellspacing="0" bordercolor="#999999">
          <tr valign="top">
            <td width="11%" rowspan="3" nowrap="nowrap" w><p><strong><span style="font-weight: bold;">&nbsp;</span>EOC<br />
            </strong><strong><span style="font-weight: bold;">&nbsp;</span>Approvals</strong></p>
              </td>
            <td width="42%" nowrap="nowrap"><span style="font-weight: bold;">&nbsp;</span>Approved for Processing by: 
              <input placeholder="" maxlength="30" name="fld14" id="fld14" size="32"  /></td>
            <td width="47%" nowrap="nowrap"><span style="font-weight: bold;">&nbsp;</span>Expenditure Request Approved by: 
              <input placeholder="" maxlength="30" name="fld15" id="fld15" size="32"  /></td>
            </tr>
          <tr valign="top">
            <td><span style="font-weight: bold;">&nbsp;</span>Position: 
              <input placeholder="" maxlength="30" name="fld16" id="fld16" size="32"  />
              <br /></td>
            <td><span style="font-weight: bold;">&nbsp;</span>Position: EOC Director (or designate) 
              <input placeholder="" maxlength="26" name="fld17" id="fld17" size="28" /></td>
            </tr>
          <tr valign="top">
            <td> <span style="font-weight: bold;">&nbsp;</span>Date/Time: 
              <input placeholder="mm/dd/yy hh:mm" maxlength="30" name="fld18" id="fld18" size="32"  /></td>
            <td><span style="font-weight: bold;">&nbsp;</span>Date/Time: 
              <input placeholder="mm/dd/yy hh:mm" maxlength="30" name="fld19" id="fld19" size="32"  /></td>
            </tr>
        </table>        
          </td>
        </tr>
    </tbody>
  </table>
    <table width="100%"  border="1" cellpadding="4" cellspacing="0" bordercolor="#999999">
      <tr valign="top">
        <td width="11%" rowspan="3" nowrap="nowrap"><strong><span style="font-weight: bold;">&nbsp;</span>PREOC <br />
                <span style="font-weight: bold;">&nbsp;</span>Approvals</strong></td>
        <td width="42%" nowrap="nowrap"><span style="font-weight: bold;">&nbsp;</span>Approved for Processing by:
            <input placeholder="" maxlength="30" name="fld20" id="fld20" size="32"  />
            <br />
            <span style="font-weight: bold;">&nbsp;</span><span style="font-weight: bold;">&nbsp;</span><span style="font-weight: bold;">&nbsp;
            <input name="fld21b" type="checkbox" id="fld21b" value="NOT APPROVED" onclick="Flip('fld21', 'NOT APPROVED')"/>
            <input name="fld21" type="hidden" id="fld21" />
            </span>Not Approved</td>
        <td width="47%" nowrap="nowrap"><span style="font-weight: bold;">&nbsp;</span>Expenditure Request Approved by:
            <input placeholder="" maxlength="28" name="fld22" id="fld22" size="30"  /></td>
      </tr>
      <tr valign="top">
        <td><span style="font-weight: bold;">&nbsp;</span>Position: Operations Section Chief: 
          <input placeholder="" maxlength="28" name="fld23" id="fld23" size="20" />          <br /></td>
        <td><span style="font-weight: bold;">&nbsp;</span>Position: PREOC Director (or designate): 
          <input placeholder="" maxlength="26" name="fld24" id="fld24" size="28" r />
          </td>
      </tr>
      <tr valign="top">
        <td><span style="font-weight: bold;">&nbsp;</span>Date/Time:
            <input placeholder="mm/dd/yy hh:mm" maxlength="30" name="fld25" id="fld25" size="32"  /></td>
        <td><span style="font-weight: bold;">&nbsp;</span>Date/Time:
            <input placeholder="mm/dd/yy hh:mm" maxlength="30" name="fld26" id="fld26" size="32"  />            </td>
      </tr>
    </table>
  
    <table width="100%"  border="1" cellspacing="0" cellpadding="2">
      <tr valign="top">
        <td width="11%"  rowspan="2" nowrap="nowrap"><strong><span style="font-weight: bold;">&nbsp;</span>Distribution </strong></td>
        <td width="42%" nowrap="nowrap"><span style="font-weight: bold;">
        <input name="fld27b" type="checkbox" id="fld27b" value="YES" onclick="Flip('fld27', 'YES')"/>
        <input name="fld27" type="hidden" id="fld27" />
        </span>EOC Director<br />
          <span style="font-weight: bold;">
          <input name="fld28b" type="checkbox" id="fld28b" value="YES" onclick="Flip('fld28', 'YES')"/>
          <input name="fld28" type="hidden" id="fld28" />
          </span>EOC Operations Section<br />
          <span style="font-weight: bold;">
          <input name="fld29b" type="checkbox" id="fld29b" value="YES" onclick="Flip('fld29', 'YES')"/>
          <input name="fld29" type="hidden" id="fld29" />
          </span>EOC Planning Section<br />
        
          <input name="fld30b" type="checkbox" id="fld30b" value="YES" onclick="Flip('fld30', 'YES')"/>
          <input name="fld30" type="hidden" id="fld30" />
          </span>EOC Logistics Section<br />
          <span style="font-weight: bold;">
          <input name="fld31b" type="checkbox" id="fld31b" value="YES" onclick="Flip('fld31', 'YES')"/>
          <input name="fld31" type="hidden" id="fld31" />
          </span>EOC Finance &amp; Admin Section<br />
          <span style="font-weight: bold;">
          <input name="fld32b" type="checkbox" id="fld32b" value="YES" onclick="Flip('fld32', 'YES')"/>
          <input name="fld32" type="hidden" id="fld32" />
          </span>Other: <input placeholder="" maxlength="28" name="fld39" id="fld39" size="30" />
          <br />            </td>
        <td width="47%" nowrap="nowrap"><span style="font-weight: bold;">
        <input name="fld33b" type="checkbox" id="fld33b" value="YES" onclick="Flip('fld21', 'YES')"/>
        <input name="fld33" type="hidden" id="fld33" />
        </span>PREOC Director<br />
          
          <input name="fld34b" type="checkbox" id="fld34b" value="YES" onclick="Flip('fld34', 'YES')"/>
          </span>          <input name="fld34" type="hidden" id="fld34" />
          </span>PREOC Operations Section<br />
          <span style="font-weight: bold;">
          <input name="fld35b" type="checkbox" id="fld35b" value="YES" onclick="Flip('fld35', 'YES')"/>
          <input name="fld35" type="hidden" id="fld35" />
          </span>PREOC Planning Section<br />
          <span style="font-weight: bold;">
          <input name="fld36b" type="checkbox" id="fld36b" value="YES" onclick="Flip('fld36', 'YES')"/>
          <input name="fld36" type="hidden" id="fld36" />
          </span>PREOC Logistics Section<br />
          <span style="font-weight: bold;">
          <input name="fld37b" type="checkbox" id="fld37b" value="YES" onclick="Flip('fld37', 'YES')"/>
          <input name="fld37" type="hidden" id="fld37" />
          </span>PREOC Finance &amp; Admin Section<br />
          <span style="font-weight: bold;"><span style="font-weight: bold;">
          <input name="fld38b" type="checkbox" id="fld38b" value="YES" onclick="Flip('fld38', 'YES')"/>
          </span>          <input name="fld38" type="hidden" id="fld38" />
          </span>Other:</span> <input placeholder="" maxlength="28" name="fld40" id="fld40" size="30" /></td>
      </tr>
      
    </table>
    <table width="100%"  border="1" cellspacing="0" cellpadding="0">
      <tr valign="top">
        <td width="11%" rowspan="2" nowrap="nowrap"><strong><span style="font-weight: bold;">&nbsp;</span>Comments:</strong></td>
        <td width="89%" nowrap="nowrap"><span style="font-weight: bold;"><strong><span style="font-weight: bold;"><strong><span style="font-weight: bold;">
          <span style="font-weight: bold;">&nbsp;</span>
          <textarea name="fld41" cols="110" rows="2" id="fld41"onchange="this.value=RWS(this.value)" onkeyup="AutoGrowTextArea(this)" ></textarea>
        </span></strong></span></strong>
          </span></td>
      </tr>
    </table></td>
</tr>

<tr class="formtext">

<td colspan="2" height="15">

<div align="left"> <span class="formtext"><span style="font-family: Calibri;"><small><span style="font-family: Calibri;"><small><big><big><small><span style="font-family: Calibri;">
  <input type="button" value="Save BC EOC Expenditure Data"  style="color: blue;"onclick="SaveData()" />
</span>&nbsp;&nbsp;<span style="color: rgb(128, 0, 0);"><span><span style="font-size: 12px;"></span></span></span>&nbsp;</small></big></big></small></span>
  <input value="Submit" style="height: 28px; width: 70px; color: green;" size="8" name="Submit" method="Post" id="Submit" enctype="multipart/form-data" class="SubmitBtn" type="submit" /></small></span></span>&nbsp;

<span class="formtext">
<input class="BtnFormat2" value="Reset Form " name="ResetForm" style="color: rgb(204, 0, 0);" type="reset" />

</span> <span class="style11"> &nbsp; &nbsp;&nbsp;&nbsp; &nbsp;</span></div></td>

<td> <span class="style12">Version 2.0 VA7MPG
  </span>
  <div align="left"><input name="Templateversion" type="hidden" id="Templateversion" value="2.0" />
</div>

</td>

</tr>

</tbody>

</table>

</form>

</body></html>